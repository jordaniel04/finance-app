<div class="transactions-container">
    <header class="transactions-header">
        <button mat-icon-button (click)="close()">
            <mat-icon>arrow_back</mat-icon>
        </button>
        <h2>Transacciones</h2>
    </header>

    <div class="transactions-list">
        <mat-accordion>
            <mat-expansion-panel *ngFor="let group of transactionGroups">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        {{group.date | date:'EEEE, d MMMM yyyy':'':'es'}}
                    </mat-panel-title>
                    <mat-panel-description class="amounts-summary">
                        <span class="income" *ngIf="group.totalIncome > 0">+{{group.totalIncome | customCurrency}}</span>
                        <span class="expense" *ngIf="group.totalExpense > 0">-{{group.totalExpense | customCurrency}}</span>
                    </mat-panel-description>
                </mat-expansion-panel-header>

                <div class="transaction-item" *ngFor="let transaction of group.transactions">
                    <div class="transaction-date">
                        {{transaction.date | date:'HH:mm'}}
                    </div>
                    <div class="transaction-info">
                        <div class="category-info">
                            <mat-icon [style.color]="transaction.categoryColor">{{transaction.categoryIcon}}</mat-icon>
                            <div class="transaction-details">
                                <span class="category-name">{{transaction.categoryName}}</span>
                                <span class="description">{{transaction.description}}</span>
                            </div>
                        </div>
                        <span class="amount" [class.income]="transaction.type === 'income'" 
                              [class.expense]="transaction.type === 'expense'">
                            {{transaction.type === 'income' ? '+' : '-'}}{{transaction.amount | customCurrency}}
                        </span>
                    </div>
                </div>
            </mat-expansion-panel>
        </mat-accordion>
    </div>

    <div class="monthly-summary">
        <div class="summary-item">
            <span class="label">Ingresos</span>
            <span class="amount income">+{{monthlyTotals.income | customCurrency}}</span>
        </div>
        <div class="summary-item">
            <span class="label">Egresos</span>
            <span class="amount expense">-{{monthlyTotals.expense | customCurrency}}</span>
        </div>
        <div class="summary-item balance">
            <span class="label">Saldo</span>
            <span class="amount" [class.income]="monthlyTotals.balance >= 0" 
                                [class.expense]="monthlyTotals.balance < 0">
                {{monthlyTotals.balance | customCurrency}}
            </span>
        </div>
    </div>

    <button mat-fab class="add-transaction-fab" color="primary" (click)="openAddTransactionDialog()">
        <mat-icon>add</mat-icon>
    </button>
</div>